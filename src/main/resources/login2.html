<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<title>${system.system_name!'OFCMS'}内容管理系统</title>
<link rel="stylesheet"href="${webroot}/static/plugins/layui/css/layui.css">
    <style>
        html,body{height:100%;}
        body{background: url(${webroot}/static/assets/image/login/bg.jpg) no-repeat center 0; background-size:100% 71%;}
        input[type="checkbox"] {
          margin: 0;
          margin-top: 0;
          line-height: normal;
      }
      .layui-form-item{margin-bottom:0;}
      .layui-form-item .layui-input-inline{width:255px;padding-left:36px;border:1px solid #f3f5f7;}
      .layui-input{height:36px;border: none;}
      .layui-form-label{padding:9px 10px 0;color:#fff;width:42px;text-align:justify;}
      .layui-form-label:after {
            content: " ";
            display: inline-block;
            width: 100%;
        }
      .login-logo{display: block;position: absolute;
      right:18px;bottom:20px;}
      .copyright{color:#333;text-align:center;position: absolute;
      bottom:60px;width:100%;}
		input:-webkit-autofill{-webkit-box-shadow: 0 0 0px 1000px white inset !important;}
      /*表单*/
      .login-center{ width:100%;position: fixed;height:360px;top:50%;margin-top:-160px;display:flex;align-items:flex-start;justify-content:center;}
      .login-center .name-box{display:flex;align-items:center;margin-right:80px;margin-top:80px;}
      .login-center>.login-input{min-width:406px; height: 280px;background-color:#87c7ea;padding:10px;display: inline-block;}
      .login-center .input-box{background-color:#0a8cbf;border-radius:8px;box-shadow:0 0 5px #666 inset;height:100%;padding-left:20px;padding-top:50px;box-sizing:border-box;}
      .username{background:url(${webroot}/static/assets/image/login/username.png) no-repeat 10px center;background-color:#fff;background-size:15px; }
      .password{background:url(${webroot}/static/assets/image/login/password.png) no-repeat 10px center;background-color:#fff;background-size:14px; }
      .code{width:45%;padding-left:10px;display: inline-block;}
      .login-btn{background-color:#fff;border-radius:200px;text-align:center;color:#0a8cbf;width:260px;height:34px;line-height:34px;font-size:16px;font-weight:400;margin:18px auto 0;display: block;box-shadow:0 0 5px #0075ad ;}
</style>
	<script type="application/javascript">
        var webroot = "${webroot!'ofcms-admin'}";
	</script>
</head>
<body>
        <img class="login-logo" src="${webroot}/static/assets/image/login/logo02.png">
        <section>
            <div class="login-center">
            <div class="name-box">
                <img class="login-left" src="${webroot}/static/assets/image/login/logo.png">
                <h2 class="tit" style="color:#fff;font-size:36px;font-weight: 900;display:inline-block;">${system.system_name!'总量控制系统'}</h2>
            </div>

                <form class="login-input layui-form">
                  <div class="input-box">
                    <div class="layui-form-item">
                        <label class="layui-form-label">用户名</label>
                        <div class="layui-input-inline username">
                           <input id="username" type="text" lay-verify="required" name="username" placeholder="账号" required class="layui-input ">
                       </div>
                   </div>
                   <div class="layui-form-item">
                    <label class="layui-form-label">密码</label>
                    <div class="layui-input-inline password">
                        <input id="password" type="password" lay-verify="required" name="password" placeholder="密码" required class="layui-input ">
                    </div>
                </div>
                   <div class="layui-form-item">
                    <label class="layui-form-label"></label>
                    <div class="layui-input-inline" style="display:flex;align-items: stretch;padding-left: 0;border: none;">
        <input id="code" class="layui-input code" type="text" name="code" placeholder="图片验证码" lay-verify="required" value="">
        <div id="v_container" style="width: 130px;height: 36px;display:inline-block;margin-left:12px;"></div>
                    </div>
                </div>
               <button class="layui-btn login-btn" lay-submit lay-filter="loginBtn" id="loginBtn">立即登录</button>
           </div>
       </div>
   </form>
</section>
<p class="copyright">©<a href = "#" target="_blank" style="color: #333">${system.copyright!'© www.ofosft.cn'}</a></p>
	<script src="${ctx}/plugins/layui/layui.js"></script>
    <script src="${ctx}/plugins/sideshow/js/TweenLite.min.js"></script>
    <script src="${ctx}/plugins/sideshow/js/EasePack.min.js"></script>
    <script src="${ctx}/plugins/sideshow/js/rAF.js"></script>
    <script src="${ctx}/plugins/sideshow/js/demo-1.js"></script>
    <script>
        layui.use(['layer', 'form'], function() {
            var layer = layui.layer,
                $ = layui.jquery,
                form = layui.form;

            $('#changeCode').on('click', function() {
                $('#changeCode > img')[0].src = 'captcha?tm='+Math.random();
            });

            //清理左侧菜单缓存
            var index = layer.load(2, {
                shade: [0.3, '#333']
            });
            $(window).on('load', function() {
                layer.close(index);
                form.on('submit(login)', function(data) {
                    var loadIndex = layer.load(2, {
                        shade: [0.3, '#333']
                    });
                    $.ajax({
					    type: "post",
					    data: data.field,
					    url: data.form.action,
					    beforeSend: function () {
					    	index = layer.load(1);
					    },
					    success: function (data) {
					    	console.log(data)
					    	if("0000" == data.code){
						    	location.href="index";
						    }else{
						    	$('#changeCode').click(); //刷新验证码
						    	layer.msg(data.msg,{icon:2})
						    }
					    },
					    error: function (data) {
					    	layer.msg("登录异常",{icon:2});
					    	$('#changeCode').click(); //刷新验证码
					    },
					    complete:function(XMLHttpRequest, textStatus){
					    	layer.close(index);
					    }
					});
                    return false;
                });
            }());
        });
    </script>
</body>
</html>