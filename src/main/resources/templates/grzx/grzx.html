<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>个人中心</title>
<link href="${ctx}/plugins/layui/css/layui.css" rel="stylesheet"/>
<link href="${ctx}/plugins/font-awesome/css/font-awesome.css" rel="stylesheet"/>
<style>
    .main{width:500px;margin: 10% auto 0;}
    .red{color:red;}
    .icon{
        display: inline-block;
        border: 1px solid #e6e6e6;
        border-left:none;
        border-radius: 0 8px 8px 0;
        height:36px;
        width:38px;
        line-height:36px;
        text-align: center;
        background-color: #f3f5f7;
    }
    .layui-form-item{
        display: flex;
        align-items: center;
    }
    .layui-form-item .layui-form-label{
        width:80px;
        text-align: right;
    }
    .layui-form-item .layui-inline {
        margin-bottom: 0;
        margin-right: 0;
        width:260px;
    }
</style>
</head>
<body>
    <form class="layui-form main">
            <div class="layui-form-item">
                <label class="layui-form-label">用户昵称:</label>
                <div class="layui-inline">
                    <input type="text" name="nickname" class="layui-input" value="${(user.nickname)!''}">
                </div>
                <div class="icon"><i class="fa fa-user"></i></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">电子邮箱:</label>
                <div class="layui-inline">
                    <input type="text" name="email" lay-verify="email" class="layui-input" value="${(user.email)!''}">
                </div>
                <div class="icon"><i class="fa fa-envelope"></i></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">手机号码:</label>
                <div class="layui-inline">
                    <input type="text" name="phone" class="layui-input" lay-verify="phone" value="${(user.phone)!''}">
                </div>
                <div class="icon"><i class="fa fa-mobile-phone"></i></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">备注:</label>
                <div class="layui-inline" style="width:300px;">
                    <textarea name="remark" required lay-verify="required" placeholder="请输入" class="layui-textarea">${(user.remark)!''}</textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">上次登录:</label>
                <div class="layui-inline">
                    <span>时间:${(user.recentlogin)!''}</span>
                </div>
            </div>
            <div class="layui-btn-container" style="text-align:center;">
                <a class="layui-btn layui-btn-sm " lay-submit lay-filter="save">保存</a>
            </div>
    </form>
</body>
</html>
<script src="${ctx}/plugins/layui/layui.all.js"></script>
<script>
    layui.use(['form', 'layer', 'upload'], function () {
        var $ = layui.jquery,
            table = layui.table,
            form = layui.form;

        form.on('submit(save)', function (data) {
        	data.field.username = "${user.username}";
            var url = "${ctx}/xtgl/zzgl/yhgl/updateUser";
            var index;
            $.ajax({
                type: "POST",
                data: data.field,
                url: url,
                beforeSend: function () {
                    index = layer.load(1);
                },
                success: function (data) {
                    layer.close(index);
                    if (data > 0) {
                        var msg = "修改成功";
                        layer.msg(msg, {offset: ['50%'], time: 1000}, function () {
                        	 parent.location.reload();
                        });
                    } else {
                        layer.msg("操作失败")
                    }
                },
                error: function (data) {
                    layer.msg("服务端异常");
                }
            });
            return false;
        });
    })
</script>