<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>角色管理</title>
	<link href="${ctx}/plugins/layui/css/layui.css" rel="stylesheet" />
	<link href="${ctx}/plugins/font-awesome/css/font-awesome.css" rel="stylesheet" />
	<style>
		.layui-table, .layui-table-view {
    margin: 0 0;
}
.head-form{
	display: flex;
	align-items: center;
	padding: 5px 0;
}
.head-form .layui-form-item {
	margin-bottom: 0;
}
.head-form .layui-form-item .layui-inline{
	margin-bottom: 0;
}
.head-form .layui-input,.head .layui-select{
	height:35px;
	line-height: 35px;
}
.head-form .layui-form-label{
	padding: 7px 10px;
}
.layui-btn-container .layui-btn {
    margin-right: 10px;
    margin-bottom: 0;
}
</style>
</head>
<body class="layui-layout-body" style="padding: 10px">
	<form class="layui-form head-form" accept-charset="utf-8">
		<div class="layui-form-item">
			<div class="layui-inline">
				<input class="layui-input" type="text" placeholder="角色名称" name="rolename">
			</div>
		</div>
		<div class="layui-form-item">
			<div class="layui-inline">
				<input class="layui-input" type="text" placeholder="角色编码" name="rolecode">
			</div>
		</div>
		<div class="layui-form-item">
			<div class="layui-input-inline">
				<select name="status">
					<option value="">全部</option>
					<option value="1">正常</option>
					<option value="0">禁用</option>
				</select>
			</div>
		</div>
		<div class="layui-btn-container">
			<a class="layui-btn layui-btn-primary" lay-submit lay-filter="search">查询</a>
			<a class="layui-btn layui-btn-primary" id="addBtn">新增</a>
		</div>
	</form>
	<table class="layui-hide" lay-filter="tableBox" id="tableBox"></table>
</body>

</html>
<script type="text/html" id="rightBar">
	<div class="layui-btn-group">
		<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="edit">
		 	<i class="fa fa-pencil"></i>
		</a>
		<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="del">
		    <i class="fa fa-trash-o"></i>
		</a>
		<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="more">
		  	<i class="fa fa-chevron-circle-left"></i>
		</a>
	 </div>	
</script>
<script type="text/html" id="switch" >
	<input type="checkbox" name="switch" lay-skin="switch" lay-filter="switchstatus" lay-text="正常|禁用" {{ d.status == '1' ? 'checked' : '' }}>
</script>
<script src="${ctx}/plugins/layui/layui.all.js"></script>
<script>
	var tableId = "tableBox";
	layui.use(['layer', 'form', 'table'], function () {
		var $ = layui.jquery,
			layer = layui.layer,
			table = layui.table,
			form = layui.form;
		table.render({
			elem: '#'+tableId,
			url: '${ctx}/xtgl/qxgl/jsgl/roles/list',
			height: 'full-50',
			title: '角色管理',
			cols: [[
					{
						title: '序号',
						type: 'numbers',
						width: 50
					}, {
						field: 'r_id',
						hide:true
					}, {
						field: 'rolename',
						align: 'center',
						title: '角色名称',
						width: 200
					}, {
						field: 'rolecode',
						align: 'center',
						title: '角色编码',
						width: 200
					}, {
						field: 'createtime',
						align: 'center',
						title: '创建时间'
					}, {
						field: 'updatetime',
						align: 'center',
						title: '更新时间'
					}, {
						field: 'remark',
						align: 'center',
						title: '备注信息'
					}, {
						field: 'status',
						align: 'center',
						title: '状态',
						width: 100,
						templet:"#switch"
					}, {
						field: 'center',
						align: 'center',
						title: '操作',
						width: 100,
						toolbar: '#rightBar'
					}
				]
			],
			page: true,
			id: tableId,
			done: function (res, curr, count) {
				form.on('submit(search)', function (data) {
					table.reload(tableId, {
						where: data.field
					});
					return false;
				});
			}
		});
		//编辑
		$("#addBtn").click(function (e) {
			layer.open({
				type: 2,
				content: 'http://sentsin.com'
			});
		});
		//监听工具条
		table.on('tool('+tableId+')', function (obj) {
			var data = obj.data;
			if (obj.event === 'edit') {
				//编辑
			} else if (obj.event === 'del') {
				layer.confirm('真的删除行么', function (index) {
					console.log(obj.data)
				});
			} else if (obj.event === 'more') {

			}
		});
		
		form.on('switch(switchstatus)', function(obj){
			var selectIfKey=obj.othis;                                  
			var parentTr = selectIfKey.parents("tr");
			var dataField = $(parentTr).find("td:eq(1)").find(".layui-table-cell").text();
		    console.log(dataField+"==="+obj.elem.checked)
		})
	})
</script>