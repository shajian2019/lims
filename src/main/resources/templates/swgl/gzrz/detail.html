<#assign ctx=req.contextPath />
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="${ctx}/plugins/layui/css/layui.css" rel="stylesheet"/>
    <link href="${ctx}/plugins/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <style type="text/css">
        /* layui重置 */
        .layui-form { width: 600px; margin: 10px auto 0; }
        .layui-form-item { display: flex; align-items: flex-start; flex-wrap: wrap; }
        .layui-form-label { width: 100px; }
        .layui-form-item .layui-inline, .layui-form-item .layui-input-block { width: 450px; }
        .layui-form-item > a { display: inline-block; height: 36px; line-height: 36px; }
        .layui-form-item .radio-box { border: 1px solid #e6e6e6; }
        .layui-btn-container { width: 600px; margin: 0 auto; text-align: center; }
        .layui-textarea { min-height: 48px; }
        /* 自定义 */
        div.icon-box { height: 36px; border: 1px solid #e6e6e6; border-left: none; background-color: #fff; border-radius: 2px; }
        .icon-box .icon { width: 36px; height: 36px; text-align: center; line-height: 36px; border-right: 1px solid #e6e6e6; display: inline-block; }
        .icon-box .layui-inline-block { display: flex; align-items: center; justify-content: space-between; }
        .icon-box .icon-input { display: inline-block; border: none; flex-grow: 1; padding: 0 10px; }
        .layui-form-item { margin-bottom: 10px; }
        .main { width: 800px; margin: 1% auto 0; }
        .img-up-box, #spr, #spr1 { max-width: 500px; height: auto; display: flex; align-items: flex-end; flex-wrap: wrap; }
        .img-up-box .img-box { position: relative; display: inline-block; width: 80px; height: 80px; border: 1px solid #e6e6e6; margin-right: 8px; margin-top: 8px; }
        .img-up-box .img-box .img-close { position: absolute; top: -7px; right: -7px; font-size: 12px; color: #fff; border-radius: 20px; width: 16px; height: 16px; background-color: #000; text-align: center; line-height: 16px; }
        .img-up-box .img-box > img { width: 100%; height: 100%; }
      #spr_add { display: flex; ; align-items: center; }
        .spr-select { text-align: center; margin-right: 15px; display: flex; align-items: center; }
        .spr-box { color: #fff; text-align: center; background-color: cornflowerblue; border-radius: 1000px; font-size: 12px; width: 70px; height: 70px; display: flex; flex-direction: column; justify-content: center; }
        .spr-close { cursor: pointer; font-size: 14px; color: #999; width: 16px; }
        #layer-photos { display: flex; align-items: center; max-width: 500px; flex-wrap: wrap; }
        #layer-photos img { width: 70px; height: 70px; display: block; margin-right: 5px; margin-bottom: 5px; }
        .layui-btn-container { position: fixed; bottom: 0; left: 0; width: 100%; height: auto; background-color: #fff; border-top: 1px solid #e6e6e6; padding-top: 10px; }
        .layui-upload-list { margin: 0; width: 450px;}
    </style>
</head>
<body>
<form class="layui-form" lay-filter="edit" style="margin: 5% auto 0;padding-bottom: 60px;">
    <div class="layui-form-item">
        <label class="layui-form-label">今日工作内容：</label>
        <div class="layui-inline">
            <textarea name="today_work_content" placeholder="请输入内容" class="layui-textarea"
                      readonly="true" value="">${(params.today_work_content)!''}</textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">未完成工作：</label>
        <div class="layui-inline">
            <textarea readonly="true" name="unfinished_work" placeholder="请输入内容" class="layui-textarea" value="">${(params.unfinished_work)!''}</textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">需协调工作：</label>
        <div class="layui-inline">
            <textarea readonly="true" name="coordinated_work" placeholder="请输入内容" class="layui-textarea" value="">${(params.coordinated_work)!''}</textarea>
        </div>
    </div>
    <#if params.flag == 'wdrz'>
    <div class="layui-form-item">
        <label class="layui-form-label">接收人：</label>
        <div class="layui-inline">
            <input name="receiver" readonly="true" id="receiver" placeholder="接收人" class="layui-input"
                   type="text" value="${(params.receiver)!''}"/>
        </div>
    </div>
    </#if>
    <#if params.flag == 'qjrz'>
    <div class="layui-form-item">
        <label class="layui-form-label">提交人：</label>
        <div class="layui-inline">
            <input name="submitter" readonly="true" id="submitter" placeholder="提交人" class="layui-input"
                   type="text" value="${(params.submitter)!''}"/>
        </div>
    </div>
    </#if>
    <div class="layui-form-item">
    <label class="layui-form-label">提交时间：</label>
    <div class="layui-inline">
        <input name="submit_time" readonly="true" id="submit_time" placeholder="提交时间" class="layui-input"
               type="text" value="${(params.submit_time)!''}"/>
    </div>
</div>
    <div class="layui-form-item">
        <label class="layui-form-label">附件：</label>
        <div class="layui-inline">
        <div class="layui-upload-list" id="demoList">
        </div>
        </div>

    </div>
    <div class="layui-btn-container">
        <a class="layui-btn  layui-btn-primary" lay-submit lay-filter="" id="cancel">关闭</a>
    </div>
</form>

<script src="${ctx}/plugins/layui/layui.js"></script>
<script type="text/javascript">
    var layer = layui.layer;
    var sprs = [];
    var attachs = [];
    layui.config({
        base: '${ctx}/plugins/layui/extend/dtree/'
    }).extend({
        dtree: 'dtree'
    })

    layui.use(['form', 'layer', 'dtree', 'upload', 'laydate'], function () {
        var upload = layui.upload
        var $ = layui.jquery
        var dtree = layui.dtree;
        var form = layui.form;

        //加载附件
        $.ajax({
            type: "POST",
            dataType: 'json',
            url: "${ctx}/swgl/gzrz/getAttachments?uniqueid=${params.uniqueid}",
            beforeSend: function () {
                //index = layer.load(1);
            },
            success: function (data) {
                if(data != null){
                    $.each(data.data, function(index, item) {
                        var html = '<a href="${ctx}/file/downloadFile?attach_id='+item.attach_id+'" class="layui-btn layui-btn-primary">'+item.attach_name+'</a>';
                        $("#demoList").append(html);
                    })
                }
            },

        });

        //取消
        $("#cancel").click(function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        })

        Array.prototype.remove = function (val) {
            var index = this.indexOf(val);
            if (index > -1) {
                this.splice(index, 1);
            }
        };


    })

</script>
</body>
</html>
